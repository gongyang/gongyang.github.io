---
title: Docker 入门系列之---认识Docker
date: 2016-1-30
---

 最近有一项很火的技术，身边很多人都在讨论他，很多技术交流会上也会提到他，没错，他就是Docker。
 Docker为什么会这么火了，我们还是先来说说另一个技术，容器。
### 容器简介
 容器技术其实已经出来很久了，其中比较成熟有Linux的LXC、FreeBSD的Jail、Solaris的Solaris Containers。容器与管理程序虚拟化（hypervisor virtualization，HV）有所不同，管理程序的虚拟化一般都是通过中间层将一台或多台独立的机器虚拟化运行于物理硬件之上，而容器则是直接运行在操作系统内核之上的用户空间。因此，容器虚拟化也被称为“操作系统级虚拟化”，容器技术可以让多个独立的用户空间运行在同一台宿主机之上。

 容器有效地将由单个操作系统管理的资源划分到孤立的组中，以更好的在孤立的组之间平衡有冲突的资源使用需求。与虚拟化相比，这样既不需要指令级模拟，也不需要即时编译。容器可以在核心CPU本地运行指令，而不需要任何专门的解释机制。此外，也避免了准虚拟化和系统调用替换中的复杂性。 通过提供一种创建和进入容器的方式，操作系统让应用程序就像在独立的机器上运行一样，但又能共享很多底层资源。例如，可以有效的共享公共文件（如glibc）的页缓存，因为所有容器都使用相同的内核，所以容器还常常共享相同的libc库（取决于容器配置）。这种共享常常可以扩展到目录中其他不需要写入内容的文件。 容器在提供隔离的同时，还通过共享这些资源节省开销，这意味着容器比真正的虚拟化开销要小很多。和传统的虚拟化以及版虚拟化相比，容器运行不需要模拟层和管理层，而是使用操作系统的系统调用接口，这降低了运行单个容器所需的开销，也使得宿主机中可以运行更多的容器。
  
 尽管有着这么多优秀技术，但是容器一直没有得到广泛使用和认可。一方面和起安全有关系，另一个很重要的原因就是容器技术的复杂性，容器本身比较复杂，不易安装，管理和自动化也很困难。而Docker就是为改变这一切而生。
    
### Docker 简介      
 Docker 是一个开源项目，于2013年由dotCloud（现改名为Docker）公司推出，一开始其实只是公司内部的一个业余项目。他是用Go语言写的，基于Apache 2.0开源授权协议发行。项目代码在[GitHub][github]上进行维护。基于 [LXC][lxc]技术之上构建的Container容器引擎。
Docker可以轻松的为任何应用创建一个轻量级的、可移植的、自给自足的容器。开发者在笔记本上编译测试通过的容器可以批量地在生产环境中部署，包括VMs（虚拟机）、bare metal、OpenStack 集群和其他的基础应用平台。

###Docker 组件
 **Docker的核心组件：**
        客户端和服务器；
        Docker镜像；
        Registry；
        Docker容器。

**Docker客户端和服务器**
Docker是一个客户-服务器（C/S）架构的程序。Docker客户端只需香Docker服务器发出请求，服务器或守护进程将完成所有工作并返回结果。Docker提供了一个命令行工具docker以及一整套[RESTfulAPI][restfulapi]。你可以在同一台宿主机上运行Docker守护进程和客户端，也可以从本地的Docker客户端连接到运行在另一台宿主机上的远程Docker守护进程。

**Docker镜像**
镜像是构建Docker世界的基石。用户基于镜像来运行自己的容器。镜像也是Docker生命周期中的构建部分。镜像是基于联合文件系统的一种层式的结构，由一系列指令一步一步构建出来。比如说：添加一个文件；执行一个命令；打开一个端口。
也可以把镜像当作容器的“源代码”。镜像体积很小，非常“便携”，易于分享、存储和更新。

**Registry**
Docker用Registry来保存用户构建的镜像。Registry分为公共和私有两种。Docker公司运营的公共Registry叫做Docker Hub。我们可以在Docker Hub上注册帐号，分享并保存自己的镜像。当然，我们也可以架设自己的私有Registry，私有的Registry可以受到防火墙的保护，将镜像保存在防火墙的后面，就像我们私有的gitlab一样。

**容器**
前面说镜像是Docker世界的基石，而容器，则是组成Docker世界的最小组件。容器是基于镜像启动的，他的主要作用是来运行应用实例的,Docker官方推荐一个容器里面只运行一个进程，当然你要运行多个进程也是可以的。容器可以被启动、开始、停止、删除。每个容器都是相互隔离的、保证安全的平台。我们可以把容器看做是一个简易版的能跑应用程序的linux环境。镜像是只读的，容器的创建是在只读的镜像最上面创建一层可写层。

###Do what
前面花了那么多时间来介绍Docker，那么我们到底能用他来做什么。

**快速开发和部署**
在实际的的工作当中，我们的环境至少分为开发、测试、生产等多个环境，环境的不同，往往导致一个程序运行结果不一样。并且配置这些环境也是相当麻烦的一件事情（因为各个部门，所使用的操作系统还不一样）
，这样就导致了一个矛盾链的产生，开发说是测试的问题，测试说是运维的问题，运维说是运行环境的问题，最后运维只能背锅。有了Docker，开发者可以使用一个标准的镜像来构建一套开发容器，开发完成之后，交给测试人员测试，运维人员可以直接使用这个容器来部署代码。Docker 可以快速创建容器，快速迭代应用程序，并让整个过程全程可见，使团队中的其他成员更容易理解应用程序是如何创建和工作的。 Docker 容器很轻很快！容器的启动时间是秒级的，大量地节约开发、测试、部署的时间。

**简单高效的虚拟化**
现在我们使用虚拟化，都是在自己的宿主机上面安装虚拟机软件，然后运行虚拟主机，一般只能运行几个虚拟主机，开多了，宿主机会很卡，就算你把内存加到16G、32G,你也只能跑几个虚拟主机，毕竟你是中间加了一层中间件。Docker 容器的运行不需要额外的 hypervisor 支持，它是内核级的虚拟化，因此可以实现更高的性能和效率。

**快速的迁移和扩展**
Docker 容器几乎可以在任意的平台上运行，包括物理机、虚拟机、公有云、私有云、个人电脑、服务器等。 这种兼容性可以让用户把一个应用程序从一个平台直接迁移到另外一个。

**轻松的运维**
使用 Docker，只需要小小的修改，就可以替代以往大量的更新工作。所有的修改都以增量的方式被分发和更新，从而实现自动化并且高效的管理。

**对比传统虚拟机总结**

|特性|容器|虚拟机|
|:---|:---|:---|
|启动|秒级|分钟级|
|硬盘使用|一般为 MB|一般为 GB|
|性能|接近原生|弱于|
|系统支持量|单机支持上千个容器|一般几十个|

好了，关于Docker的介绍就到这里，接下来我们就开始Docker的详细操作使用



[restfulapi]:https://docs.docker.com/engine/reference/api/docker_remote_api/ 
[github]:https://github.com/docker/docker
[lxc]:https://zh.wikipedia.org/wiki/LXC






